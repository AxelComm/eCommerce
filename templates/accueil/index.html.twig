{% extends 'base.html.twig' %}

{% block title %}Accueil{% endblock %}

{% block body %}
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans|Varela+Round">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <!-- Product section-->
    <div class="imgback">
        <img src="{{ asset('img/banniere.jpg') }}" alt="">
    </div>
    <!-- Related items section-->
    <section class="carou">
        <h1></h1>
    <div class="wrapper">
        <i id="left"> <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg> </i>
        <ul class="carousel" style="background: black; ">
            <li class="card">
                <div class="img"><img src="{{ asset('img/casqueps5.jpg') }}" alt="img" draggable="false"></div>
                <h2>Casque Playstation 5</h2>
                <a href="{{ path('app_shop') }}"><span>Voir en Boutique</span></a>
            </li>
            <li class="card">
                <div class="img"><img src="{{ asset('img/iphone14.jpg') }}" alt="img" draggable="false"></div>
                <h2>Iphone 14 ProMax</h2>
                <a href="{{ path('app_shop') }}"><span> Voir en Boutique</span></a>
            </li>
            <li class="card">
                <div class="img"><img src="{{ asset('img/consoleps5.jpg') }}" alt="img" draggable="false"></div>
                <h2>Playstation 5</h2>
                <a href="{{ path('app_shop') }}"><span>Voir en Boutique</span></a>
            </li>
            <li class="card">
                <div class="img"><img src="{{ asset('img/acer.jpg') }}" alt="img" draggable="false"></div>
                <h2>PC Gamer Acer Nitro 5</h2>
                <a href="{{ path('app_shop') }}"><span>Voir en Boutique</span></a>
            </li>
            <li class="card">
                <div class="img"><img src="{{ asset('img/manetteXbox.jpg') }}" alt="img" draggable="false"></div>
                <h2>Manette Xbox serie</h2>
                <a href="{{ path('app_shop') }}"><span>Voir en Boutique</span></a>
            </li>
            <li class="card">
                <div class="img"><img src="{{ asset('img/xbox.png') }}" alt="img" draggable="false"></div>
                <h2>Xbox serie X</h2>
                <a href="{{ path('app_shop') }}"><span>Voir en Boutique</span></a>
            </li>
        </ul>
        <i id="right"> <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"/></svg></i>
    </div>
    </section>

    <section class="corppub">
        <div class="pub">
            <img id="imagePrincipale" src="{{ asset('img/pub/pubxbox.jpg') }}">
        </div>
        <div class="pub">
            <div>
                <div class="image-container">
                    <img src="{{ asset('img/pub/pubxbox.jpg') }}" onclick="afficherImage('{{ asset('img/pub/pubxbox.jpg') }}')">
                </div>
            </div>
            <div>
                <div class="image-container">
                    <img src="{{ asset('img/pub/pubps5.webp') }}" onclick="afficherImage(' {{ asset('img/pub/pubps5.webp') }}')">
                </div>
            </div>
            <div>
                <div class="image-container">
                    <img src="{{ asset('img/pub/pubpcportable.jpg') }}" onclick="afficherImage('{{ asset('img/pub/pubpcportable.jpg') }}')">
                </div>
            </div>
            <div>
                <div class="image-container">
                    <img src="{{ asset('img/pub/pubpsvr2.png') }}" onclick="afficherImage('{{ asset('img/pub/pubpsvr2.png') }}')">
                </div>
            </div>
            <div>
                <div class="image-container">
                    <img src="{{ asset('img/pub/pubcasque.jpg') }}" onclick="afficherImage('{{ asset('img/pub/pubcasque.jpg') }}')">
                </div>
            </div>
            <div>
                <div class="image-container">
                    <img src="{{ asset('img/pub/pubmanetteps5.jpg') }}" onclick="afficherImage('{{ asset('img/pub/pubmanetteps5.jpg') }}')">
                </div>
            </div>
            <div>
                <div class="image-container">
                    <img src="{{ asset('img/pub/pubcasquegamer.jpg') }}" onclick="afficherImage('{{ asset('img/pub/pubcasquegamer.jpg') }}')">
                </div>
            </div>
        </div>
    </section>
    <div class="divbutboutique">
    <button class="butboutique"><a href="{{ path('app_shop') }}">Acceder a la boutique</a></button>
    </div>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <script>
        //script pour changement d'image
        function afficherImage(src) {
            var imagePrincipale = document.getElementById("imagePrincipale");
            imagePrincipale.src = src;
        }

        //script pour carousel
        const wrapper = document.querySelector(".wrapper");
        const carousel = document.querySelector(".carousel");
        const firstCardWidth = carousel.querySelector(".card").offsetWidth;
        const arrowBtns = document.querySelectorAll(".wrapper i");
        const carouselChildrens = [...carousel.children];

        let isDragging = false, isAutoPlay = true, startX, startScrollLeft, timeoutId;

        // Get the number of cards that can fit in the carousel at once
        let cardPerView = Math.round(carousel.offsetWidth / firstCardWidth);

        // Insert copies of the last few cards to beginning of carousel for infinite scrolling
        carouselChildrens.slice(-cardPerView).reverse().forEach(card => {
            carousel.insertAdjacentHTML("afterbegin", card.outerHTML);
        });

        // Insert copies of the first few cards to end of carousel for infinite scrolling
        carouselChildrens.slice(0, cardPerView).forEach(card => {
            carousel.insertAdjacentHTML("beforeend", card.outerHTML);
        });

        // Scroll the carousel at appropriate postition to hide first few duplicate cards on Firefox
        carousel.classList.add("no-transition");
        carousel.scrollLeft = carousel.offsetWidth;
        carousel.classList.remove("no-transition");

        // Add event listeners for the arrow buttons to scroll the carousel left and right
        arrowBtns.forEach(btn => {
            btn.addEventListener("click", () => {
                carousel.scrollLeft += btn.id == "left" ? -firstCardWidth : firstCardWidth;
            });
        });

        const dragStart = (e) => {
            isDragging = true;
            carousel.classList.add("dragging");
            // Records the initial cursor and scroll position of the carousel
            startX = e.pageX;
            startScrollLeft = carousel.scrollLeft;
        }

        const dragging = (e) => {
            if(!isDragging) return; // if isDragging is false return from here
            // Updates the scroll position of the carousel based on the cursor movement
            carousel.scrollLeft = startScrollLeft - (e.pageX - startX);
        }

        const dragStop = () => {
            isDragging = false;
            carousel.classList.remove("dragging");
        }

        const infiniteScroll = () => {
            // If the carousel is at the beginning, scroll to the end
            if(carousel.scrollLeft === 0) {
                carousel.classList.add("no-transition");
                carousel.scrollLeft = carousel.scrollWidth - (2 * carousel.offsetWidth);
                carousel.classList.remove("no-transition");
            }
            // If the carousel is at the end, scroll to the beginning
            else if(Math.ceil(carousel.scrollLeft) === carousel.scrollWidth - carousel.offsetWidth) {
                carousel.classList.add("no-transition");
                carousel.scrollLeft = carousel.offsetWidth;
                carousel.classList.remove("no-transition");
            }

            // Clear existing timeout & start autoplay if mouse is not hovering over carousel
            clearTimeout(timeoutId);
            if(!wrapper.matches(":hover")) autoPlay();
        }

        const autoPlay = () => {
            if(window.innerWidth < 800 || !isAutoPlay) return; // Return if window is smaller than 800 or isAutoPlay is false
            // Autoplay the carousel after every 2500 ms
            timeoutId = setTimeout(() => carousel.scrollLeft += firstCardWidth, 2500);
        }
        autoPlay();

        carousel.addEventListener("mousedown", dragStart);
        carousel.addEventListener("mousemove", dragging);
        document.addEventListener("mouseup", dragStop);
        carousel.addEventListener("scroll", infiniteScroll);
        wrapper.addEventListener("mouseenter", () => clearTimeout(timeoutId));
        wrapper.addEventListener("mouseleave", autoPlay);
    </script>
{% endblock %}